                         14|copy-pamm-api  | ‚ú® Ciclo completado en 974ms. Trades replicados: 0                                      14|copy-pamm-api  | [15:13:30.121] INFO (1116): ::1 - - [05/Nov/2025:18:13:30 +0000] "GET /api/v1/pamm/fund/729dd687-961f-4dc9-b19f-bd9d0c56835c/withdrawals?limit=50&status=pending HTTP/1.1" 200 864 "-" "python-httpx/0.28.1"                                              14|copy-pamm-api  | [2025-11-05T18:13:30.792Z] üîç Buscando nuevas operaciones para 

index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.517Z] INFO: [Supabase Config] Loading configuration... {url: 'https://ukngiipxprielwdfuvln.supabase.co', keyPrefix: 'eyJhbGciOiJIUzI1NiIs...', keyLength: 208, envMode: 'production'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.527Z] INFO: [Supabase Config] Testing connection to Supabase... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.528Z] INFO: Supabase client initialized {url: 'https://ukngiipxprielwdfuvln.supabase.co'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.528Z] INFO: [Database Adapter] Using provider: supabase 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.593Z] INFO: Configuration loaded successfully {environment: 'production', appName: 'AGM Broker', version: '1.0.0'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.667Z] INFO: [AUTH] Setting up onAuthStateChange listener... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.667Z] INFO: [AUTH] [Supabase] Setting up auth state listener... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.714Z] INFO: [AUTH] [Supabase] Auth state change triggered {event: 'SIGNED_IN', userPresent: true}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.714Z] INFO: [AUTH] [Supabase] User authenticated, passing to callback 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.715Z] INFO: [AUTH] onAuthStateChange callback received {userPresent: true, userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', email: '[REDACTED]', previousUserId: undefined, previousEmail: undefined}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.715Z] INFO: [AUTH] User change detection {userChanged: {‚Ä¶}, previousExists: false, currentExists: true, idMatch: false, emailMatch: false}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.716Z] INFO: [AUTH] User changed or first load, reloading userData 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.716Z] INFO: [AUTH] User is authenticated. Fetching data... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.794Z] INFO: [AUTH] [Supabase] Auth state change triggered {event: 'INITIAL_SESSION', userPresent: true}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.794Z] INFO: [AUTH] [Supabase] User authenticated, passing to callback 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.795Z] INFO: [AUTH] onAuthStateChange callback received {userPresent: true, userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', email: '[REDACTED]', previousUserId: 'a153a6d6-e48d-4297-9a64-395c462e138f', previousEmail: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.795Z] INFO: [AUTH] User change detection {userChanged: false, previousExists: true, currentExists: true, idMatch: true, emailMatch: true}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:31.796Z] INFO: [AUTH] User hasn't changed (token refresh), keeping existing userData 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.027Z] INFO: [Supabase Config] Connection test successful 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.062Z] INFO: [DB Adapter] User data retrieved: {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', hasData: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.062Z] INFO: [AUTH] User data fetched successfully 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.063Z] INFO: [AUTH] User KYC status: {kyc_status: 'approved', kyc_verified: true}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.313Z] INFO: [Supabase] Found 1 payment methods for user 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.313Z] INFO: [AUTH] Setting loading to false. 
index-jg-g4Ng9.js:979 [Dashboard - src] renderContent checking selectedOption: Dashboard
index-jg-g4Ng9.js:979 [Dashboard - src] Current KYC status in renderContent: {userData_exists: true, kyc_status: 'approved', kyc_verified: true, selectedOption: 'Dashboard'}
index-jg-g4Ng9.js:609 [Sidebar] User data received: {exists: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:979 [Dashboard] userData updated: {exists: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:979 [Dashboard - src] selectedOption state updated to: Dashboard
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.462Z] INFO: [CHAT_CONTEXT] User ID changed, initializing chat service {previousUserId: null, currentUserId: 'a153a6d6-e48d-4297-9a64-395c462e138f'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.466Z] INFO: [ENHANCED_CHAT] Chat service initialized with knowledge base 
index-jg-g4Ng9.js:632 Debug AccountsContext - User ID changed, loading accounts {previousUserId: null, currentUserId: 'a153a6d6-e48d-4297-9a64-395c462e138f'}
index-jg-g4Ng9.js:632 Debug AccountsContext - Loading accounts for user: a153a6d6-e48d-4297-9a64-395c462e138f
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.476Z] INFO: Fetching trading accounts for user {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.479Z] INFO: [CHAT_CONTEXT] Calling getOrCreateConversation... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:32.479Z] INFO: [CHAT] getOrCreateConversation called for user: a153a6d6-e48d-4297-9a64-395c462e138f
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.095Z] INFO: [DB Adapter] User data retrieved: {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', hasData: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.202Z] INFO: [DB Adapter] User data retrieved: {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', hasData: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.265Z] INFO: Trading accounts fetched successfully {count: 3}
index-jg-g4Ng9.js:632 Debug AccountsContext - getUserTradingAccounts result: {success: true, accounts: Array(3)}
index-jg-g4Ng9.js:632 Debug AccountsContext - Raw accounts with types: (3)¬†[{‚Ä¶}, {‚Ä¶}, {‚Ä¶}]
index-jg-g4Ng9.js:632 Debug AccountsContext - Organized accounts: {Cuentas Reales: Array(1), Cuentas Demo: Array(2), Copytrading: Array(0), Pamm: Array(0)}
index-jg-g4Ng9.js:632 Debug AccountsContext - Auto-selecting most recent real account: {id: 'd9de165f-2e4a-4b8a-9a4d-1fdfdc4a945a', user_id: 'a153a6d6-e48d-4297-9a64-395c462e138f', account_number: '102809', account_name: 'Juanes Test', account_type: 'Real',¬†‚Ä¶}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.270Z] INFO: [CHAT] Found existing conversation: a5d6c54a-2c83-4c90-b804-205c5e3afc3d
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.271Z] INFO: [CHAT_CONTEXT] Got conversation ID: a5d6c54a-2c83-4c90-b804-205c5e3afc3d
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.273Z] INFO: [CHAT_CONTEXT] Subscribing to realtime messages for: a5d6c54a-2c83-4c90-b804-205c5e3afc3d
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.278Z] INFO: [CHAT_CONTEXT] Realtime subscription initiated 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.278Z] INFO: [CHAT_CONTEXT] About to load messages from DB... 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.279Z] INFO: [CHAT_CONTEXT] Loading messages from DB for conversation: a5d6c54a-2c83-4c90-b804-205c5e3afc3d
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.732Z] INFO: [CHAT_CONTEXT] No messages found in DB for conversation: a5d6c54a-2c83-4c90-b804-205c5e3afc3d
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.733Z] INFO: [CHAT_CONTEXT] Loading conversation history with ID: conversation_a153a6d6-e48d-4297-9a64-395c462e138f
index-jg-g4Ng9.js:51 [2025-11-05T18:12:33.733Z] INFO: [CHAT_CONTEXT] Chat service initialized successfully 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:34.126Z] INFO: [CHAT_CONTEXT] Subscription status: SUBSCRIBED
index-jg-g4Ng9.js:51 [2025-11-05T18:12:34.126Z] INFO: [CHAT_CONTEXT] Successfully subscribed to realtime updates 
index-jg-g4Ng9.js:51 [2025-11-05T18:12:34.127Z] INFO: [CHAT_CONTEXT] Fetching recent messages from last 10 seconds 
index-jg-g4Ng9.js:609 [Sidebar] handleNavigation called with: Pamm KYC status: approved
index-jg-g4Ng9.js:615 [Sidebar] Clicked on button for: Gestor under Pamm
index-jg-g4Ng9.js:609 [Sidebar] handleSubOptionClick called with: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] handleSidebarOptionChange received: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] Current userData KYC status: {kyc_status: 'approved', kyc_verified: true, userDataExists: true}
index-jg-g4Ng9.js:979 [Dashboard - src] Calling setSelectedOption with: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] renderContent checking selectedOption: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] Current KYC status in renderContent: {userData_exists: true, kyc_status: 'approved', kyc_verified: true, selectedOption: 'Pamm Gestor'}
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 0 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Fetching manager stats...
index-jg-g4Ng9.js:979 [Dashboard - src] selectedOption state updated to: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] renderContent checking selectedOption: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] Current KYC status in renderContent: {userData_exists: true, kyc_status: 'approved', kyc_verified: true, selectedOption: 'Pamm Gestor'}
index-jg-g4Ng9.js:979 [PammGestorAdmin] Manager stats response: {overview: {‚Ä¶}, funds: Array(2), investors: Array(1), performance_chart: Array(30), last_updated: '2025-11-05T18:12:43.866Z'}
index-jg-g4Ng9.js:979 [PammGestorAdmin] Funds found: 2
index-jg-g4Ng9.js:979 [PammGestorAdmin] Investors found: 1
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:609 [Sidebar] handleNavigation called with: Dashboard KYC status: approved
index-jg-g4Ng9.js:979 [Dashboard - src] handleSidebarOptionChange received: Dashboard
index-jg-g4Ng9.js:979 [Dashboard - src] Current userData KYC status: {kyc_status: 'approved', kyc_verified: true, userDataExists: true}
index-jg-g4Ng9.js:979 [Dashboard - src] Calling setSelectedOption with: Dashboard
index-jg-g4Ng9.js:979 [Dashboard - src] renderContent checking selectedOption: Dashboard
index-jg-g4Ng9.js:979 [Dashboard - src] Current KYC status in renderContent: {userData_exists: true, kyc_status: 'approved', kyc_verified: true, selectedOption: 'Dashboard'}
index-jg-g4Ng9.js:979 [Dashboard - src] selectedOption state updated to: Dashboard
index-jg-g4Ng9.js:51 [2025-11-05T18:12:59.040Z] INFO: [DB Adapter] User data retrieved: {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', hasData: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:51 [2025-11-05T18:12:59.110Z] INFO: [DB Adapter] User data retrieved: {userId: 'a153a6d6-e48d-4297-9a64-395c462e138f', hasData: true, kyc_status: 'approved', kyc_verified: true, email: 'support@alphaglobalmarket.io'}
index-jg-g4Ng9.js:609 [Sidebar] handleNavigation called with: Pamm KYC status: approved
index-jg-g4Ng9.js:615 [Sidebar] Clicked on button for: Gestor under Pamm
index-jg-g4Ng9.js:609 [Sidebar] handleSubOptionClick called with: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] handleSidebarOptionChange received: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] Current userData KYC status: {kyc_status: 'approved', kyc_verified: true, userDataExists: true}
index-jg-g4Ng9.js:979 [Dashboard - src] Calling setSelectedOption with: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] renderContent checking selectedOption: Pamm Gestor
index-jg-g4Ng9.js:979 [Dashboard - src] Current KYC status in renderContent: {userData_exists: true, kyc_status: 'approved', kyc_verified: true, selectedOption: 'Pamm Gestor'}
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 0 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Fetching manager stats...
index-jg-g4Ng9.js:979 [Dashboard - src] selectedOption state updated to: Pamm Gestor
index-jg-g4Ng9.js:979 [PammGestorAdmin] Manager stats response: {overview: {‚Ä¶}, funds: Array(2), investors: Array(1), performance_chart: Array(30), last_updated: '2025-11-05T18:13:09.787Z'}
index-jg-g4Ng9.js:979 [PammGestorAdmin] Funds found: 2
index-jg-g4Ng9.js:979 [PammGestorAdmin] Investors found: 1
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
index-jg-g4Ng9.js:979 [PammGestorAdmin] Rendering with accountsData: 2 funds
